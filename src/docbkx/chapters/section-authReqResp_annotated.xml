<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE glossary [
<!ENTITY % common SYSTEM "../../common/common.ent">
%common;
]>
<section  xmlns="http://docbook.org/ns/docbook" 
	xmlns:xi="http://www.w3.org/2001/XInclude"
	xmlns:xlink="http://www.w3.org/1999/xlink"
               version="5.0"
               xml:id="Sample_Request_Response-d1e64">
	<?dbhtml stop-chunking?>
	
<title>Annotated authentication request and response</title>
	
	<para>The annotated authentication request and response illustrates a general use case for
		authenticating to the Rackspace Cloud by using user name and API key credentials. </para>
    <note><para>For more information, see the <link xlink:href="QuickStart-000.html">step-by-step
                authentication instructions in the Quickstart Guide</link> and additional
            authentication examples in <link xlink:href="Token_Calls.html">Token operations API
                reference</link>.</para></note>
	
         <section xml:id="annotated_auth_req">
	           <title>Sample authentication request</title>
	           <para> The following authentication request <link
                xlink:href="Sample_Request_Response-d1e64.html#authReqJson">JSON</link> and <link
                xlink:href="Sample_Request_Response-d1e64.html#authReqXML">XML</link> examples show
            the authentication header and request body for the <guilabel>POST tokens</guilabel> API
            operation. When you authenticate, use your own credentials for user name and API key
            rather than the sample values shown in the examples. For attribute descriptions, see the
                <link xlink:href="Sample_Request_Response-d1e64.html#auth_req_attributes"
                >authentication request attribute descriptions</link> in the table following the
            examples.</para>

	           <example xml:id="authReqJson">
		             <title>Authentication request with headers: JSON</title>
		
		             <programlisting language="json">
POST /v2.0/tokens HTTP/1.1
Host: identity.api.rackspacecloud.com
Content-Type: application/json
Accept: application/json

{"auth": 
 {"RAX-KSKEY:apiKeyCredentials": 
		{"username":"yourUserName", 
		  "apiKey":"a4bbc55a951242c48b03e88e32123456"}
	}
}
</programlisting>
	           </example>
	           <example xml:id="authReqXML">
		             <title>Authentication request with headers: XML</title>
		
		             <programlisting language="xml">
POST /v2.0/tokens HTTP/1.1
Host: identity.api.rackspacecloud.com
Accept: application/xml
Content-type: application/xml

  &lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
  &lt;auth&gt;
    &lt;apiKeyCredentials 
         xmlns="http://docs.rackspace.com/identity/api/ext/RAX-KSKEY/v1.0"
         username="yourUserName"
         apiKey="a4bbc55a951242c48b03e88e32123456"/&gt;
    &lt;/auth&gt;
</programlisting>
	           </example>
	           <table rules="all" xml:id="auth_req_attributes" width="100%">
			            <caption>Authentication request attribute descriptions</caption>
            <col width="31%"/>
            <col width="6%"/>
            <col width="611px"/>
			            <thead>
				              <tr>
					                <th valign="top">Attribute</th>
                    <th>Type</th>
					                <th>Description</th>
				              </tr>
			            </thead>
			            <tbody>
				              <tr>
					                <td>
                        <parameter>auth</parameter>
                    </td>
                    <td>Object</td>
					                <td>
						                  <para>The auth object provides the credentials for the authentication
                            request.</para>
					                </td>
				              </tr>
				              <tr>
					                <td>
                        <parameter>RAX-KSKEY:apiKeyCredentials</parameter>
                    </td>
                    <td>String</td>
					                <td>
					                    <para>The API key associated with the Rackspace Cloud account. You can find
                            your API key on the Account Settings page in the Cloud Control panel.
                            After logging in, click your user ID. Then, select Account Settings from
                            the menu. </para>
                        <para>You can authenticate using other credentials like password or
                            multi-factor authentication passcode. For details, see the <link
                                xlink:href="Token_Calls.html">Tokens API operation
                            reference</link>.</para>
					                </td>
				              </tr>
			                <tr>
			                    <td><parameter>username</parameter>
			                    </td>
			                    <td>String</td>
			                    <td>This value is the user name that you use to log in to the Rackspace Cloud
			                        Control Panel at <link xlink:href="http://mycloud.rackspace.com/"
			                            >http://mycloud.rackspace.com</link>.</td>
			                </tr>
				              <tr>
					                <td>
                        <parameter>tenantId</parameter>
                     </td>
                    <td>String<?sbr?>(Optional)</td>
					                <td>
						                  <para>Some services have multiple layers of authentication, with
                            service-specific credentials in addition to vendor-specific credentials.
                            In such cases, associating a user with a tenant can be a method of
                            passing that additional level of identifying information to the
                            service.</para>
					                </td>
				              </tr>
			            </tbody>
		          </table>
         </section>
	        <section xml:id="annotated_auth_resp" xreflabel="authentication response">
		<?dbhtml stop-chunking?>
		          <title>Sample authentication response</title>
		          <para>When you submit a <guilabel>POST tokens</guilabel> authentication request with
            valid credentials, the Identity service returns a response. The following authentication
            response  <link xlink:href="Sample_Request_Response-d1e64.html#json_auth_resp"
                >JSON</link> and <link xlink:href="Sample_Request_Response-d1e64.html#xml_auth_resp"
                >XML</link> examples show the entire authentication response header and body
            content. </para>
        <para>The sections that follow these examples provide detailed information about the
            following parts of the response: </para>
	            <itemizedlist>
	                <listitem>
	                    <para>
                    <guilabel>Token resource.</guilabel> The <link
                        xlink:href="Sample_Request_Response-d1e64.html#authTokenAttribsResp">token
                        object</link> returns a scoped authentication token that can be used to
                    access Rackspace Cloud services for the specified tenant. Token scope is
                    determined by tenant and user role assignments for the authenticated
                    user.</para>
	                </listitem>
	                <listitem>
	                    <para><guilabel>Service catalog resource</guilabel> The <link
                        xlink:href="Sample_Request_Response-d1e64.html#authSvccatResp">service
                        catalog object</link> returns a list of service objects that provide the
                    endpoint and description for each service that can be accessed using the
                    authentication token.</para>
	                <para audience="admin">Identity administrators can create, view, and manage
                    endpoint and service information by using the following API resources: <itemizedlist>
                        <listitem>
                            <para>
                                <link xlink:href="Endpoint_Calls.html">Endpoint</link> and <link
                                    xlink:href="Endpoint_Template_Calls.html">Endpoint
                                    templates</link>
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <link xlink:href="Service_API_Calls.html">Service APIs</link> and
                                    <link xlink:href="Service_Calls.html">Service</link>
                            </para>
                        </listitem>
                    </itemizedlist></para>
	                </listitem>
	                <listitem>
	                    <para><guilabel>User resource </guilabel>The <link
                        xlink:href="Sample_Request_Response-d1e64.html#authUserResp">user
                        object</link> returns the user name, ID, default Cloud service region, and
                    information about the roles assigned to the user. User role assignments
                    determine the API operations available to a user after authenticating to a
                    Rackspace Cloud service.</para>
	                </listitem>
	            </itemizedlist>
		          <example xml:id="json_auth_resp">
			            <title>Authentication response: JSON</title>
			            <programlisting language="json"><xi:include href="../../common/samples/auth-annotated.json" parse="text"/>

		</programlisting>
		          </example>
	            <example xml:id="xml_auth_resp">
	                <title>Authentication response: XML</title>
	                <programlisting language="xml"><xi:include href="../../common/samples/auth-annotated.xml" parse="text"/>
		</programlisting>
	            </example>
		          <section xml:id="authTokenResp" xreflabel="Token object">
	<?dbhtml stop-chunking?>
               <title>Token resource: authentication response attributes</title>
	              <para> The token object supplies a scoped authentication token that customers and
                processes can use to access Rackspace Cloud services for the specified tenant. Token
                scope is determined by tenant and user role assignments for the authenticated user.
                Responses can be in <link
                    xlink:href="Sample_Request_Response-d1e64.html#tokenResp-json">JSON</link> or
	                  <link xlink:href="Sample_Request_Response-d1e64.html#tokenResp-xml">XML</link>
                as shown in the following examples. For details, see the  <link
                    xlink:href="Sample_Request_Response-d1e64.html#authTokenAttribsResp">token object
                    attribute descriptions</link> in the table following the examples. 
	                  
	                  <example
                    xml:id="tokenResp-json">
                    <title>Authentication response: Token object in JSON format</title>
                    <programlisting language="json">
		        {
        "token": {
            "id": "d74f592f986e4d6e995853ccf0123456",
            "expires": "2015-06-05T16:24:57.637Z",
            "tenant": {
                "id": "123456",
                "name": "123456"
            },
            "RAX-AUTH:authenticatedBy": [
                "APIKEY"
            ]
        }
		</programlisting>
                </example>
                <example xml:id="tokenResp-xml">
                    <title>Authentication response: Token object in XML format</title>
                    <programlisting>
		
    &lt;token id="abcdef123ghi4j5k67m8910n12op3qrs" expires="2014-12-05T17:36:38.662Z"&gt;
        &lt;tenant id="123456" name="123456"/&gt;
        &lt;rax-auth:authenticatedBy&gt;
            &lt;rax-auth:credential&gt;APIKEY&lt;/rax-auth:credential&gt;
        &lt;/rax-auth:authenticatedBy&gt;
    &lt;/token&gt;

		</programlisting>
                </example>
            </para>
	              <table rules="all" width="100%" xml:id="authTokenAttribsResp">
		                <caption>Authentication response: Token object attributes descriptions</caption>
		                <col width="21%"/>
		                <col width="13%"/>
		                <col width="66%"/>
		                <thead>
			                  <tr>
				                    <th align="center">Attribute</th>
				                    <th align="center">Type</th>
				                    <th align="center">Description</th>
			                  </tr>
		                </thead>
		                <tbody>
			                  <tr>
				                    <td align="left">
					                      <para>
						                        <code role="hyphenate-true">id</code>
					                      </para>
				                    </td>
				                    <td align="left">
					                      <para>​String</para>
					                      <para>
						                        <emphasis>(Optional)</emphasis>
					                      </para>
				                    </td>
				                    <td>
					                      <para>The unique, system-assigned ID for the authentication token. The token ID can be
							presented to a service as evidence of authentication. Tokens are valid
							for a finite duration; a token's default lifespan is twenty-four hours.
							In the authentication response example, the token is
								<code>aaaaa-bbbbb-ccccc-dddd</code>.</para>
				                    </td>
			                  </tr>
			                  <tr>
				                    <td align="left">
					                      <para>
						                        <code role="hyphenate-true">expires</code>
					                      </para>
				                    </td>
				                    <td align="left">
					                      <para>​String</para>
					                      <para>
						                        <emphasis>(Required)</emphasis>
					                      </para>
				                    </td>
				                    <td>
					                      <para>A timestamp that indicates when the token expires.</para>
					                      <para>By default, a token id expires 24-hours after being
						generated, unless the token is revoked before it
						expires. Clients are encouraged to cache the token until
						it expires. After the token expires, client users and
						applications must re-authenticate to get a new
						token.</para>
				                    </td>
			                  </tr>
			                  <tr condition="admin">
				                    <td align="left">
					                      <para>
						                        <code role="hyphenate-true">tenant</code>
					                      </para>
				                    </td>
				                    <td align="left">
                           <para>Identity:Tenant <emphasis>(Optional)</emphasis>
				                       </para>
                        </td>
				                    <td>
					                      <para>The tenant object provides the
						<parameter>name</parameter> and
						<parameter>ID</parameter> for the tenant that users can access 
						with the supplied token.</para>
				                    </td>
			                  </tr>
			                  <tr>
				                    <td align="left">
					                      <para>
						                        <code>RAX-AUTH:AuthenticatedBy</code>
					                      </para>
				                    </td>
				                    <td align="left">
					                      <para>​String</para>
					                      <para>
						                        <emphasis>(Required)</emphasis>
					                      </para>
				                    </td>
				                    <td>
					                      <para>Indicates the type of authentication credentials used to generate the token, which can include
						the following values:</para>
				                       
					                      <para>
						                        <itemizedlist>
						                            <listitem>
						                                <para>
						                                    <literal>APIKEY</literal> for the API key assigned to the user account.</para>
						                            </listitem>
						                            <listitem>
						                                <para>
						                                    <literal>PASSCODE</literal> sent to a mobile phone associated with a user account.</para>
						                            </listitem>
						                            <listitem condition="admin">
						                                <para>
						                                    <literal>OTPPASSCODE</literal> sent to an OTP (one-time passcode) device associated with a user account.</para>
						                            </listitem>
							                          <listitem>
								                            <para>
                                       <literal>PASSWORD</literal> for Rackspace Cloud account password.</para>
							                          </listitem>	
							                      		
							                          <listitem condition="admin">
									                           <para>
                                       <literal>RSAKey</literal> for Racker SSO
										credentials.</para>
								                         </listitem>
								                         <listitem condition="admin">
									                           <para>
                                       <literal>IMPERSONATION</literal> if an authorized user 
									has authenticated by assuming the idenity of a provisioned or federated user.
									</para>
								                         </listitem>
							                          <listitem>
                                    <para>
                                       <literal>FEDERATED</literal> if the user authenticated through a trusted 
								third-party Identity provider.</para>
                                 </listitem>
						                        </itemizedlist>
					                      </para>
				                    </td>
			                  </tr>
		                </tbody>
	              </table>
	           </section>
	           <section xml:id="authSvccatResp" xreflabel="Service catalog object">
		<?dbhtml stop-chunking?>
		             <title>Service catalog resource: Authentication response attributes</title>
		             <para>The Service catalog object provides service and endpoint information for services that you
			can access with the authentication token returned in the authentication response.</para>
		             <para>The information returned for a service is determined by the Identity service
                configuration and the tenant and role assignments of the authenticated user. For
                example, if a service has an endpoint for administrative use that endpoint is
                classified as an AdminURL. The AdminURL is only visible to authenticated Service
                administrators (role = <code>service:admin</code>) and Idenity administrators (role
                = <code>identity:admin</code>).</para>
	               <para>Responses can be in <link
					xlink:href="Sample_Request_Response-d1e64.html#svcCatResp-xml">XML</link> or
					<link xlink:href="Sample_Request_Response-d1e64.html#svcCatResp-json"
					>JSON</link>. For details, see <link
					xlink:href="Sample_Request_Response-d1e64.html#authSrvcatAttribsResp">service
					resource object attribute descriptions</link>. <example xml:id="svcCatResp-json">
					<title>Authentication response: Service catalog object in JSON format</title>
					<programlisting language="json"><xi:include href="../../common/samples/auth-annotated-svccat.json" parse="text"/>
		</programlisting>
				</example>
				<example xml:id="svcCatResp-xml">
					<title>Authentication response: Service catalog object in XML format</title>
					<programlisting language="xml"><xi:include href="../../common/samples/auth-annotated-svccat.xml" parse="text"/>         
		                 </programlisting>
				</example>
			</para>
		             <table xml:id="authSrvcatAttribsResp" rules="all" width="100%">
			               <caption>Authentication response: Service catalog object attribute descriptions</caption>
                <col width="15%"/>
                <col width="20%"/>
                <col width="15%"/>
                <col width="50%"/>
			               <thead>
				                 <tr>
					                   <th valign="top">Object</th>
					                   <th>Attribute</th>
                        <th>Type</th>
					                   <th>Description</th>
				                 </tr>
			               </thead>
			               <tbody>
				                 <tr>
					                   <td rowspan="2">
                           <parameter>service</parameter>
                        </td>
					                   <td>
                           <parameter>name</parameter>
                        </td>
                        <td>String</td>
					                   <td>
						                     <para>The service name attribute identifies each unique service in the
							catalog. Service names are defined in the Identity service configuration
							and do not change. However, new services of the same service type can be
							added to the catalog with new names.</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>type</parameter>
                        </td>
                        <td>String</td>
					                   <td>
						                     <para>The type of service provided at the specified endpoint-- for
								example <parameter>compute</parameter>,
									<parameter>object-store</parameter>, or
									<parameter>rax:loadbalancer</parameter>.</para>
						                     <para>Service types categorize the services registered with OpenStack or
								custom types registered with the Rackspace Cloud Identity service.
								For a list of service types, see <link
									xlink:href="Svc_Catalog_ovw.html">Service
									types</link>.</para>
					                   	<para><emphasis role="bold">Important: </emphasis>Use service type as the
								primary value for locating a service. If multiple endpoints of the
								same service type exist in the same region, use service name as the
								tiebreaker. See <link
									xlink:href="Svc_Catalog_ovw.html#Sample_Catalog_Workflow-d1e266">Suggested
									workflow for processing a Service Catalog
								response</link>.</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td rowspan="6">
						                     <para>
                              <parameter>endpoints</parameter> (JSON)</para>
						                     <para>or</para>
						                     <para>
                              <parameter>endpoint</parameter> (XML)</para>
					                   </td>
					                   <td>
                           <parameter>region</parameter>
                        </td>
                        <td>String</td>
					                   <td>
						                     <para>The location of the Rackspace data center where the specified service
							is hosted. Accessing a service from a regional endpoint allows clients
							to provision resources in a manner that provides high
							availability.</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>tenantId</parameter>
                        </td>
                        <td>String</td>
					                   <td>
						                     <para>Some services recognize specification of a tenant. If a service
								recognizes tenants, the format of the tenant specification is
								defined only by the service.  For details about whether and how to
								specify a tenant, check the documentation for the service you are
								using.</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>publicURL</parameter>
                           <?sbr?>
						                     <parameter>internalURL</parameter>
                           <?sbr?>
						                     <parameter>AdminURL</parameter>
                        </td>
                        <td>URI</td>
					                   <td>
						                     <para>An endpoint can be assigned public, internal, and administrative
								service URLs. Access to a public URL usually incurs traffic charges.
								Internal and admin URLs are accessible only to services within the
								same region. Access to an internal URL is free of charge.</para>
						                     <para>The URL includes the API version and tenant ID for services that
								require it. For example, in the
									<code>https://iad.servers.api.rackspacecloud.com/v2/12345</code>
								URL, the version ID is 2 and the tenant ID is 12345. (The tenant ID
								is also referred to as the account number.)</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>versionId</parameter>
                        </td>
                        <td>String</td>
					                   <td>
						                     <para>Specifies the API version for the endpoint. The API version is also
							included in the URL to access the service.</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>versionInfo</parameter>
                        </td>
                        <td>URI</td>
					                   <td>
						                     <para>URI to get information about the specified API version. You can
								also retrieve information about an API version by using the Show
								version details API operation for the specified service--for
								example,  <code>GET <replaceable>endpointURL//</replaceable>
									<parameter>v</parameter>
									<replaceable>version_number</replaceable>
								</code> .</para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>versionList</parameter>
                        </td>
                        <td>URI</td>
					                   <td>
						                     <para>URI to get information about all versions. You can also retrieve this
							information by using the List versions API operation for the specified
							service, <code>GET <replaceable>endpointURL</replaceable>
                              </code> for
							example.</para>
					                   </td>
				                 </tr>
			               </tbody>
		             </table>
	           </section>
	           <section xml:id="authUserResp" xreflabel="User object">
		<?dbhtml stop-chunking?>
		             <title>User resource: authentication response attributes</title>
		             <para>The user object returns account information for the authenticated user that includes user
			name, ID, default region assignment, and information about role assignments.</para>
		             <para>Users can have multiple roles, with each role providing specific privileges.
		                 For example, each account has an <link xlink:href="Role_Based_Access_Control-d1e808.html#Account-Users-d1e910"
                    >Identity role</link> such as <code>Identity:default</code> to authenticate and
                gain access to Identity service capabilities and any other <link
                    xlink:href="Role_Based_Access_Control-d1e808.html">RBAC roles</link> assigned to
                the account.</para>
	           	<para>Responses can be in <link xlink:href="Sample_Request_Response-d1e64.html#userResp-json">JSON</link> or 
	           		<link xlink:href="Sample_Request_Response-d1e64.html#userResp-xml">XML</link>. For details, see the 
	           		<link xlink:href="Sample_Request_Response-d1e64.html#authUserAttribsResp">user object attribute descriptions</link> in 
	           		the table following the examples..  
			              
			               <example xml:id="userResp-json">
				                 <title>Authentication response: User object in JSON format</title>
				                 <programlisting language="json"><xi:include href="../../common/samples/auth-annotated-user.json" parse="text"/>
		       
		                         </programlisting>
			               </example>
	           		<example xml:id="userResp-xml">
	           			<title>Authentication response: User object in XML format</title>
	           			<programlisting><xi:include href="../../common/samples/auth-annotated-user.xml" parse="text"/>
	           			</programlisting>
	           		</example>
		             </para>
		           
		             <table xml:id="authUserAttribsResp" rules="all" width="100%">
			               <caption>Authentication response: User object attributes</caption>
				<col width="10%"/>
				<col width="272pt"/>
				<col width="8%"/>
				<col width="60%"/>
				<col width="1%"/>
			               <thead>
				                 <tr>
					                   <th valign="top">Object</th>
					                   <th>Attribute</th>
						<th>Type</th>
					                   <th>Description</th>
				                 </tr>
			               </thead>
			               <tbody>	
				                 <tr>
					                   <td rowspan="3">
                           <parameter>User</parameter>
                        </td>
					                   <td>
                           <parameter>id</parameter>
                        </td>
						<td>String</td>
					                   <td>
						                     <para>The unique, system-generated ID assigned to the user account. The user
							ID is required by many API operations for managing user accounts and
							information.  </para>
					                   </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>name</parameter>
                        </td>
						<td>String</td>
					                   <td>The name assigned to the user account. </td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>RAX-AUTH:default Region</parameter>
                        </td>
						<td>String</td>
					                   <td>If API requests to a Rackspace Cloud service do not explicitly specify a region and
						multiple endpoints are available, the <parameter>RAX-AUTH:default
							Region</parameter> determines which region is selected by default. Use
						the Update user API operation to change the value.</td>
				                 </tr>
				                 <tr>
					                   <td rowspan="4">
						                     <para>
                              <parameter>roles</parameter>
                           </para>
					                   </td>
					                   <td>
                           <parameter>id</parameter>
                        </td>
						<td>String</td>
					                   <td>The unique, system-generated ID assigned to the role in the Identity system.</td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>name</parameter>
                        </td>
						<td>String</td>
					                   <td>The name that identifies the role in the Identity system.</td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>description</parameter>
                        </td>
						<td>String</td>
					                   <td>Provides information about the role and its intended use.</td>
				                 </tr>
				                 <tr>
					                   <td>
                           <parameter>tenantID</parameter>
                        </td>
						<td>String</td>
					                   <td>
						                     <para>Identifies the tenant for which the role is scoped.</para>
					                   </td>
				                 </tr>
			               </tbody>
		             </table>
	           </section>
	        </section>
      </section>
